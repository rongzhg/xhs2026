# 小红书内容监控系统 - 快速开始指南

## 系统已启动并运行！

应用地址: **http://localhost:5000**

---

## ? 系统检查清单

### ? 已验证的系统组件

| 组件 | 状态 | 说明 |
|------|------|------|
| XHS库 | ? | 已安装 |
| Flask框架 | ? | v3.1.2 |
| 数据库 | ? | JSON格式，已配置 |
| 爬取模块 | ? | 已修复并运行 |
| 转换模块 | ? | 已加载 |
| API接口 | ? | 9个端点可用 |
| Cookie验证 | ? | 账号已配置 |
| 网络连接 | ? | 可访问小红书服务 |

### ? 当前配置

- **已配置账号**: 2个
  - 账号1: 大师兄 (360485984)
  - 账号2: 我自己的账号 (227837619)

---

## ? 使用步骤

### 1?? 访问应用

在浏览器中打开:
```
http://localhost:5000
```

### 2?? 配置采集账号（如需添加）

1. 点击左侧菜单"账号管理"
2. 输入账号信息:
   - 账号用户名（自定义）
   - 小红书用户ID（从个人主页URL获取）
   - Cookie（按以下步骤获取）

**如何获取Cookie:**

1. 用小红书账号登录: https://xiaohongshu.com/
2. 按 `F12` 打开开发者工具
3. 点击 "Application" (应用) 标签
4. 左侧找到 "Cookies"
5. 选择 "xiaohongshu.com"
6. 在右侧找到名为 `a1` 和 `web_session` 的Cookie
7. 全选复制Cookie值（整个列表）
8. 粘贴到"Cookie"输入框

### 3?? 爬取内容

1. 点击左侧菜单"内容管理"
2. 点击"拉取内容"按钮
3. 选择要采集的账号
4. 输入目标用户ID
   - 小红书用户ID 形如: `123456789`
   - 从目标用户个人主页URL中获取
5. 点击"开始爬取"

**等待爬取完成...**

### 4?? 查看内容

爬取完成后，内容会显示在"内容管理"表格中

- **内容类型**: 显示为 视频/图片/文字
- **转换状态**: 显示是否已转换为文本
- **发布时间**: 显示内容发布时间
- **原始链接**: 指向小红书原文

### 5?? 查看详情

1. 点击任意内容的"查看详情"按钮
2. 在弹窗中查看:
   - 完整内容描述
   - 转换后的文本
   - 媒体信息

### 6?? 内容转换（可选）

1. 对视频/图片类内容，点击"转换为文本"按钮
2. 系统将调用转换模块将视频/图片转换为文本
3. 转换完成后自动保存

---

## ? API端点（高级用法）

如果需要通过API调用，以下是可用的端点:

### 账号管理
```
POST   /api/accounts              - 添加账号
GET    /api/accounts              - 获取所有账号
DELETE /api/accounts/<account_id> - 删除账号
```

### 内容管理
```
POST   /api/fetch-content         - 爬取内容
GET    /api/contents/user/<user_id> - 获取用户内容
GET    /api/contents/type         - 按类型获取内容
GET    /api/contents/<note_id>    - 获取单条内容
```

### 转换和统计
```
POST   /api/convert-content/<note_id> - 转换内容
GET    /api/statistics            - 获取统计数据
```

---

## ? 故障排除

### 问题1: 爬取失败 - "Cookie为空"

**原因**: 账号没有正确设置Cookie

**解决方案**:
1. 打开浏览器开发者工具 (F12)
2. 进入 "Application" 标签
3. 找到 "xiaohongshu.com" 的 Cookies
4. 复制所有Cookie值
5. 更新账号信息，重新粘贴Cookie

---

### 问题2: 爬取失败 - "无法获取用户信息"

**原因**: 
- 用户ID不正确
- 账号没有权限访问该用户信息
- 网络连接问题

**解决方案**:
1. 验证用户ID是否正确
   - 访问目标用户小红书主页
   - 复制URL中的用户ID
2. 检查账号权限
   - 确保账号已登录且处于活跃状态
3. 刷新Cookie
   - 重新登录并复制新的Cookie

---

### 问题3: 爬取返回空结果 - "该用户未发布内容"

**原因**: 
- 用户确实没有发布内容
- 用户隐私设置或账号被禁用

**解决方案**:
1. 在小红书APP中手动验证该用户是否有内容
2. 确认账号状态是否正常

---

### 问题4: 网络连接错误

**原因**: 
- 网络连接不稳定
- 防火墙阻止
- 小红书服务不可用

**解决方案**:
1. 检查网络连接
2. 尝试访问 https://xiaohongshu.com/ 验证连通性
3. 检查防火墙/代理设置
4. 稍后重试

---

## ? 日志查看

### 查看服务器日志

服务器日志会在终端中输出，包含:
- 请求信息
- 爬取进度
- 错误信息

### 调试模式

应用运行在Debug模式，可以:
- 看到详细的错误信息
- 自动重启检测文件变更

---

## ?? 高级配置

### 配置文件

编辑 `xhs_monitor/config.py` 可以修改:
- 端口号
- 调试模式
- 数据存储位置

### 环境变量（可选）

设置以下环境变量以使用外部API:
```
VIDEO_API_URL=http://your-api.com/video
IMAGE_API_URL=http://your-api.com/image
```

---

## ? 数据存储

- **账号数据**: `data/accounts.json`
- **内容数据**: `data/contents.json`

数据以JSON格式存储，可直接查看和编辑。

---

## ? 相关资源

- [小红书官网](https://xiaohongshu.com/)
- [项目Github](https://github.com/)
- [XHS库文档](https://github.com/ReaJason/xhs)

---

## ? 最佳实践

### 爬取建议

1. **定期更新Cookie**
   - 每周至少更新一次Cookie
   - Cookie过期会导致爬取失败

2. **合理控制爬取频率**
   - 避免在短时间内大量爬取
   - 小红书可能会限制请求频率

3. **验证数据准确性**
   - 爬取后检查数据是否完整
   - 对于重要数据进行备份

4. **妥善保管账号信息**
   - 不要将Cookie分享给他人
   - 定期更换密码

---

## ? 支持

如有问题，请:

1. 查看[故障排除](#-故障排除)章节
2. 查看系统日志获取错误详情
3. 运行诊断工具: `python test_fetch.py`

---

**祝您使用愉快！** ?

